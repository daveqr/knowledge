# Cross-Site Request Forgery (CSRF)

CSRF, short for Cross-Site Request Forgery, is a type of security vulnerability that occurs when an attacker tricks a user into unknowingly performing actions on a web application without his consent or knowledge. These actions can include anything from changing account settings to initiating financial transactions.

## How does it work

1. **Malicious Link or Page**: An attacker lures a user into visiting a malicious website or clicking on a link.

1. **Unauthorized Request**: The attacker's website or code sends unauthorized requests to a targeted web application where the user is authenticated.

1. **User's Credentials**: Since the user is already authenticated with the targeted application, the application processes the request as if it were initiated by the user himself.

1. **Unauthorized Actions**: The attacker effectively forges requests, leading to unauthorized actions or changes within the user's account or session.


## Preventing

To defend against CSRF attacks, web applications commonly use a security mechanism called a CSRF token. This token is a random value generated by the server and associated with the user's session.

When a user interacts with a web form or makes a request, the CSRF token is included in the request data. The server then verifies that the token matches the one associated with the user's session. If they don't match, the server rejects the request, protecting against CSRF attacks.

1. Server generates and stores the CSRF Token
	* When a user logs in, the server generates a unique token
	* The token is a long, random string that can't be guessed.
	* Associate the token with the user session.
1. Include the token in forms and requests
	* For any sensitive action (e.g. changing password, making a financial transaction) include the token in the form as a hidden input field
	* Alternatively, include the token as a custom HTTP header
	* Ensure the token is only accesible within the user's sessions
2. Validate the token
	* When a form is submitted or a request made, the server validates the token by comparing the token sent to the one in the user's session.
	* If the token's don't match, reject the request
3. Automatically regenerate the token
	* For added security, regenerate the token on each request. This ensures that even if an attacker obtains the token, it becomes invalid for future requests.
